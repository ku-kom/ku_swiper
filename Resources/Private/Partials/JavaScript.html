<html xmlns:f="http://typo3.org/ns/TYPO3/CMS/Fluid/ViewHelpers" data-namespace-typo3-fluid="true">
<f:section name="SwiperJsScript">
  <f:variable name="totalcount">{records -> f:count()}</f:variable>
  <f:variable name="swiper">swiper{data.uid -> f:format.raw()}</f:variable>

  <f:if condition="{totalcount} > 1 && {data.pi_flexform.autoplay} === '1'">
    <f:then>
      <f:variable name="autoplay">
        <f:format.raw>autoplay: {delay: <f:format.raw>{data.pi_flexform.slideSpeed}</f:format.raw>, disableOnInteraction: false},</f:format.raw>
      </f:variable>
    </f:then>
    <f:else>
      <f:variable name="autoplay">autoplay: false,</f:variable>
    </f:else>
  </f:if>

  <f:variable name="loop">{data.pi_flexform.loop -> f:format.raw()}</f:variable>
  <f:if condition="{loop} === '1'">
    <f:then>
      <f:variable name="loop">
        <f:format.raw>loop: true,</f:format.raw>
      </f:variable>
    </f:then>
    <f:else>
      <f:variable name="autoplay">loop: false,</f:variable>
    </f:else>
  </f:if>
  <f:if condition="{totalcount} < 2 && {data.pi_flexform.autoplay} === '1'">
    <f:variable name="loop">loop: false,</f:variable>
  </f:if>

  <f:if condition="{data.pi_flexform.fade} === '1'">
    <f:variable name="fade"><f:format.raw>effect: 'fade', fadeEffect: { crossFade: true },</f:format.raw></f:variable>
  </f:if>

  <f:if condition="{data.pi_flexform.centeredSlides} === '1'">
    <f:variable name="centeredSlides"><f:format.raw>centeredSlides: true,</f:format.raw></f:variable>
  </f:if>

  <f:if condition="{data.pi_flexform.randomStart} === '1'">
    <f:variable name="randomStart">initialSlide: Math.floor(Math.random() * ({totalcount -> f:format.raw()} - 0 + 1) + 0),</f:variable>
  </f:if>
  
  <f:if condition="{data.pi_flexform.reachedEnd} === '1' && {data.pi_flexform.autoplay} === '1'">
    <f:variable name="reachedEnd"> reachEnd: function(){ ss_{swiper}.pauseSwiper(); }, </f:variable>
  </f:if>

  <f:if condition="{totalcount} > 1 && {data.pi_flexform.lazyLoad} === '1'">
    <f:variable name="lazyload"><f:format.raw>lazy: true,</f:format.raw></f:variable>
  </f:if>

  <KuSwiper:addJsFooterInlineCode name="swiper{data.uid -> f:format.raw()}" compress="true">
    document.addEventListener('DOMContentLoaded', () => {
      const {swiper} = new Swiper('.<f:format.raw>{swiper}</f:format.raw>', {
          <f:format.raw>{autoplay}</f:format.raw>
          <f:format.raw>{loop}</f:format.raw>
          <f:format.raw>{randomStart}</f:format.raw>
          <f:format.raw>{fade}</f:format.raw>
          <f:format.raw>{centeredSlides}</f:format.raw>
          <f:format.raw>{lazyload}</f:format.raw>
          spaceBetween: 20,
          pagination: {
            el: '.<f:format.raw>{swiper}</f:format.raw>-dots',
            clickable: true,
          },
          navigation: {
            nextEl: '.<f:format.raw>{swiper}</f:format.raw>-next',
            prevEl: '.<f:format.raw>{swiper}</f:format.raw>-prev',
          },
          a11y: true,
          slidesPerView: <f:format.raw>{data.pi_flexform.slidesToShow-smartphone}</f:format.raw>,
          slidesPerGroup: <f:format.raw>{data.pi_flexform.slidesToScroll-smartphone}</f:format.raw>,
          on: {
            <f:format.raw>{reachedEnd}</f:format.raw>
          },
          breakpoints: {
            576: {
              slidesPerView: <f:format.raw>{data.pi_flexform.slidesToShow-smartphone}</f:format.raw>,
              slidesPerGroup: <f:format.raw>{data.pi_flexform.slidesToScroll-smartphone}</f:format.raw>,
            },
            768: {
              slidesPerView: <f:format.raw>{data.pi_flexform.slidesToShow-tablet}</f:format.raw>,
              slidesPerGroup: <f:format.raw>{data.pi_flexform.slidesToScroll-tablet}</f:format.raw>,
            },
            992: {
              slidesPerView: <f:format.raw>{data.pi_flexform.slidesToShow-desktop}</f:format.raw>,
              slidesPerGroup: <f:format.raw>{data.pi_flexform.slidesToScroll-desktop}</f:format.raw>,
            },
            1200: {
              slidesPerView: <f:format.raw>{data.pi_flexform.slidesToShow-widescreen}</f:format.raw>,
              slidesPerGroup: <f:format.raw>{data.pi_flexform.slidesToScroll-widescreen}</f:format.raw>,
            },
        },  
      });
        
      <f:if condition="{data.pi_flexform.autoplay} === '1' && {totalcount} > 1">
        const ss_{swiper} = new SwiperState({swiper}, '.btn-{swiper}');
      </f:if>
    });
  </KuSwiper:addJsFooterInlineCode>
</f:section>

</html>